<Window xmlns="https://github.com/avaloniaui"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:icons="using:FluentIcons.Avalonia"
	xmlns:vm="clr-namespace:xsm.ViewModels.Windows"
	x:Class="xsm.UI.Views.Windows.DownloadManagerWindow"
	x:DataType="vm:DownloadManagerViewModel"
	Title="Download Manager"
	Width="1220"
	Height="680"
	MinWidth="600"
	MinHeight="400"
	WindowStartupLocation="CenterOwner">
	<Grid RowDefinitions="*,Auto"
		RowSpacing="12"
		Margin="12">
		<Border Grid.Row="0"
			Padding="8"
			CornerRadius="6"
			BorderThickness="1"
			BorderBrush="#D0D5DD">
			<DataGrid x:Name="DownloadsGrid"
				Classes="xsm-grid"
				ItemsSource="{Binding Items}"
				AutoGenerateColumns="False"
				HeadersVisibility="Column"
				CanUserResizeColumns="True"
				CanUserReorderColumns="False"
				CanUserSortColumns="False"
				HorizontalScrollBarVisibility="Auto"
				IsReadOnly="True"
				SelectionMode="Single"
				x:CompileBindings="False"
				DoubleTapped="DownloadsGrid_OnDoubleTapped">

			  <DataGrid.Columns>

			    <DataGridTemplateColumn Header=""
			                            Width="45"
			                            MinWidth="45"
			                            CanUserResize="True">
			      <DataGridTemplateColumn.CellTemplate>
			        <DataTemplate>
			          <StackPanel Orientation="Vertical"
			                      Spacing="2"
			                      HorizontalAlignment="Center">
			            <Button Click="MoveUp_OnClick"
			                    IsEnabled="{Binding CanMoveUp}"
			                    Width="24"
			                    Height="22">
			              <icons:FluentIcon Icon="ChevronUp"
			                                IconVariant="Regular"
			                                IconSize="Size12" />
			            </Button>
			            <Button Click="MoveDown_OnClick"
			                    IsEnabled="{Binding CanMoveDown}"
			                    Width="24"
			                    Height="22">
			              <icons:FluentIcon Icon="ChevronDown"
			                                IconVariant="Regular"
			                                IconSize="Size12" />
			            </Button>
			          </StackPanel>
			        </DataTemplate>
			      </DataGridTemplateColumn.CellTemplate>
			    </DataGridTemplateColumn>

			    <DataGridTextColumn Header="Model"
			                        Binding="{Binding DisplayName}"
			                        Width="5.2*"
			                        MinWidth="240"
			                        CanUserResize="True" />

			    <DataGridTextColumn Header="Version"
			                        Binding="{Binding Version}"
			                        Width="2.2*"
			                        MinWidth="220"
			                        CanUserResize="True" />

			    <DataGridTemplateColumn Header="Status"
			                            Width="1.3*"
			                            MinWidth="120"
			                            CanUserResize="True">
			      <DataGridTemplateColumn.CellTemplate>
			        <DataTemplate>
			          <TextBlock Text="{Binding StatusText}"
			          	Classes="xsm-grid-status"
			            VerticalAlignment="Center"/>
			        </DataTemplate>
			      </DataGridTemplateColumn.CellTemplate>
			    </DataGridTemplateColumn>

			    <DataGridTemplateColumn Header="Progress"
			                            Width="1.4*"
			                            MinWidth="260"
			                            CanUserResize="True">
			      <DataGridTemplateColumn.CellTemplate>
			        <DataTemplate>
			          <StackPanel Spacing="4" VerticalAlignment="Center">
			            <ProgressBar Minimum="0"
			                         Maximum="100"
			                         Value="{Binding ProgressPercent}"
			                         Height="6" />
			            <TextBlock Text="{Binding ProgressText}"
			            	FontSize="11"
			            	Classes="xsm-grid-muted" />
			          </StackPanel>
			        </DataTemplate>
			      </DataGridTemplateColumn.CellTemplate>
			    </DataGridTemplateColumn>

			    <DataGridTextColumn Header="Speed"
			                        Binding="{Binding SpeedText}"
			                        Width="1.4*"
			                        MinWidth="150"
			                        CanUserResize="True" />

			    <DataGridTemplateColumn Header=""
			                            Width="1.2*"
			                            MinWidth="120"
			                            CanUserResize="True">
			      <DataGridTemplateColumn.CellTemplate>
			        <DataTemplate>
			          <Button Click="CancelItem_OnClick"
			                  IsEnabled="{Binding CanCancel}"
			                  HorizontalAlignment="Center">
			            <StackPanel Orientation="Horizontal"
			                        Spacing="6">
			              <icons:FluentIcon Icon="Dismiss"
			                                IconVariant="Regular"
			                                IconSize="Size12" />
			              <TextBlock Text="Cancel" />
			            </StackPanel>
			          </Button>
			        </DataTemplate>
			      </DataGridTemplateColumn.CellTemplate>
			    </DataGridTemplateColumn>
			  </DataGrid.Columns>
			</DataGrid>
		</Border>

		<Border Grid.Row="1"
			Padding="8"
			CornerRadius="6"
			BorderThickness="1"
			BorderBrush="#D0D5DD">
			<Grid ColumnDefinitions="*,Auto"
				ColumnSpacing="16">
				<StackPanel Orientation="Vertical"
					Spacing="4">
					<TextBlock Text="{Binding TotalSizeText, StringFormat=Total size: {0}}" />
					<TextBlock Text="{Binding AfterDownloadText, StringFormat=After downloads: {0}}" />
					<TextBlock Text="{Binding DiskStatsText}" />
					<TextBlock Text="{Binding LocalFolderSizeText}" />
					<TextBlock Text="{Binding AggregateSpeedText, StringFormat=Network: {0}}" />
				</StackPanel>

				<StackPanel Grid.Column="1"
					Orientation="Vertical"
					Spacing="8"
					HorizontalAlignment="Right">
					<StackPanel Orientation="Horizontal"
						Spacing="6"
						VerticalAlignment="Center">
						<CheckBox IsChecked="{Binding IsParallelEnabled}"
							IsEnabled="{Binding CanParallelize}"
							Content="Parallel downloads" />
					</StackPanel>
					<StackPanel Orientation="Horizontal"
						Spacing="6"
						VerticalAlignment="Center">
						<TextBlock Text="Limit"
							VerticalAlignment="Center" />
						<NumericUpDown Width="110"
							MinWidth="110"
							Minimum="1"
							Maximum="99"
							Value="{Binding MaxConcurrentDownloads}"
							IsEnabled="{Binding CanAdjustParallelLimit}" />
					</StackPanel>
					<Button Content="Cancel All"
						IsEnabled="{Binding HasActiveDownloads}"
						Click="CancelAll_OnClick" />
				</StackPanel>
			</Grid>
		</Border>
	</Grid>
</Window>
